function getConfigs(t){const[n,e]=t,o=n/2,i=e/2;return function t(r){const c=Math.round(.618*r);const u=Math.round(.1*c);const s=16*c+8*u;if(s>n)return r=Math.round(.98*r),t(r);const a=`bold ${.618*r}px monospace`;const f=Math.round(.618*c);const l=3*c;const h=l+r;const d=o+c;const S=d+5*c+3*u;const g=o-5*c-3*u;const O=g-3*c-u;const p=Math.round(1.618*r);const R=[{Class:Text,config:{text:"BRING THE NUMBER BACK!",x:o,y:c,color:COLORS.c5,stroke:COLORS.c2,fontSize:c,fontFamily:"fantasy"}},{Class:Text,config:{text:"YOUR GUESS",x:d,y:l,color:COLORS.c4,stroke:COLORS.c2,fontSize:f,fontWeight:"bold",align:"left",fontFamily:"system-ui"}},{Class:Text,config:{text:"ROBOT GUESS",x:o-c,y:l,color:COLORS.c3,stroke:COLORS.c2,fontSize:f,fontWeight:"bold",align:"right",fontFamily:"system-ui"}},{Class:Text,config:{text:"SCORE",x:S,y:l,color:COLORS.c3,stroke:COLORS.c2,fontSize:f,fontWeight:"bold",align:"left",fontFamily:"system-ui"}},{Class:Text,config:{text:"SCORE",x:O+2*c+u,y:l,color:COLORS.c4,stroke:COLORS.c2,fontSize:f,fontWeight:"bold",align:"right",fontFamily:"system-ui"}}];return{width:n,height:e,centerX:o,centerY:i,initBlockY:h,rightBlockX:d,leftBlockX:g,rightBlockX1:S,leftBlockX1:O,stepHeight:p,digitBlockConfig:{dw:c,dh:r,dg:u,df:a},staticItems:R}}(Math.round(e/16))}const COLORS={c1:"#26717F",c2:"#0A4B59",c3:"#B19F3C",c4:"#F2AC29",c5:"#DB5C43"},RESULTS={USER:"You won!.A genuine triumph of the human mind!.Hit Space to beat that piece of metal again",ROBOT:"You lose.Don't sweat.Hit Space to try again.",DRAW:"It's a draw.You almost there.Hit Space to try again.",DUPLICATE_GUESS:"Oops!.You already have this variant.Think harder))",SCORE_ERROR:"Oops!.There is an error in your scores.Hit Space to restart the game."},INPUT_TYPES={GUESS:"guess",SCORE:"score"};function Game(t,n,e){const{centerX:o,centerY:i,initBlockY:r,rightBlockX:c,leftBlockX:u,rightBlockX1:s,leftBlockX1:a,stepHeight:f,digitBlockConfig:l}=e,h=new Robot,d=new ResultDisplay(o,i,l),S=createTexture(l,COLORS.c4,COLORS.c1),g=createTexture(l,COLORS.c3,COLORS.c1);let O,p,R,m,y;return{start:function(){O=0,p=[],h.start(),E(h.getGuess())}};function C(t){const n=t.join("");if(R(),p.includes(n))T(RESULTS.DUPLICATE_GUESS),m.reset(),M(m,C);else{p.push(n),x(h.getScore(t))}}function w(t){R(),y=t,h.handleScore(t)?T(RESULTS.SCORE_ERROR):E()}function x(n){const e=r+O*f,o=n?s:a,i=n?COLORS.c3:COLORS.c4,c=n?g:S,u=new InputSet(INPUT_TYPES.SCORE,o,e,l,i,c);if(t.add(u),n){u.setDigits(n),1==++O&&t.add(d);const e=function(t){let n=null,e=k(t),o=k(y);o&&e?n=RESULTS.DRAW:o?n=RESULTS.ROBOT:e&&(n=RESULTS.USER);return n}(n);if(e)T(e);else{E(h.getGuess())}}else M(u,w)}function E(n){const e=r+O*f,o=n?u:c,i=n?COLORS.c3:COLORS.c4,s=n?g:S,a=new InputSet(INPUT_TYPES.GUESS,o,e,l,i,s);t.add(a),n?(a.setDigits(n),x()):M(a,C)}function M(t,e){t.activate(e),R=n.subscribe(t.onKey),m=t}function T(n){t.moveToTop(d),d.show(n)}function k(t){return 4===t[0]&&4===t[1]}}function InputItem(t,n,e,{dw:o,dh:i,dg:r,df:c},u,s,a){const f=n+t*(o+r),l=f+o/2,h=e+i/2;let d,S="",g=!1,O=!1,p=10*i;return{render:function(){d.fillStyle=g?COLORS.c5:u,d.fillRect(f,e,o,i),O?d.drawImage(a,0,p,o,i,f,e,o,i):(d.fillStyle=s,d.font=c,d.fillText(S,l,h))},setContext:function(t){d=t},setDigit:function(t){S=t,O=!0;const n={dy:p};tween(n,{dy:t*i},300,"outElastic",function(){p=n.dy},function(){p=t*i,O=!1})},activate:function(){g=!0},deactivate:function(){g=!1}}}function InputSet(t,n,e,o,i,r){let c,u,s,a=null,f=[];const l=t===INPUT_TYPES.SCORE;l?(u=2,s=function(t){return t<=4}):(u=4,s=function(t){return!f.includes(t)});const h=Array.from({length:u},(t,c)=>new InputItem(c,n,e,o,i,COLORS.c1,r));return{render:function(){h.forEach(t=>t.render())},setContext:function(t){h.forEach(n=>n.setContext(t))},setDigits:function(t){h.forEach((n,e)=>n.setDigit(t[e]))},activate:function(t){c=t,h[a=0].activate()},onKey:function(t){t.isDigit?function(t){if(!s(t))return;const n=f[a];if(f[a]=t,l&&S(f[0])&&S(f[1])&&(4===f[0]&&3===f[1]||!(f[0]>=f[1])))return void(f[a]=n);h[a].setDigit(t),d()}(t.digit):t.isArrowRight?d():t.isArrowLeft?function(){h[a].deactivate(),(a-=1)<0&&(a=u-1);h[a].activate()}():t.isEnter&&f.length===u&&(h[a].deactivate(),a=null,c(f))},reset:function(){f=[],h.forEach(t=>t.setDigit(""))}};function d(){h[a].deactivate(),h[a=(a+1)%u].activate()}function S(t){return Number.isInteger(t)}}function Keyboard(){const t={};let n=[],e=!1;return window.addEventListener("keyup",function(e){const o=Number(e.key),i={};r=e.key," "===r?i.isSpace=!0:!function(t){return Number.isInteger(t)}(o)?i[`is${e.key}`]=!0:(i.digit=o,i.isDigit=!0);var r;n.forEach(n=>t[n](i))}),{subscribe:function(e){const o=Date.now();return t[o]=e,n=Object.keys(t),function(){delete t[o],n=Object.keys(t)}},lock:function(){e=!0},unlock:function(){e=!1}}}const world=new World,help=document.querySelector(".help-outer"),keyboard=new Keyboard,configs=getConfigs(world.getBounds()),game=new Game(world,keyboard,configs);let isFirstRun=!0,isHelpShown=!0;function init(){world.reset(),configs.staticItems.forEach(createStaticItem),game.start()}function createStaticItem({Class:t,config:n}){const e=new t(n);world.add(e)}function onKey(t){t.isEscape?(isFirstRun&&(isFirstRun=!1,init()),toggleHelp()):t.isSpace&&init()}function toggleHelp(){isHelpShown=!isHelpShown,help.style.display=isHelpShown?"table":"none"}function ResultDisplay(t,n,{dw:e,dh:o}){let i,r="",c="",u="",s=0,a=.03;const f=4e3;let l=!1;const h=`bold ${.618*o}px monospace`,d=`bold ${.618*o*.618}px monospace`,S=16*e,g=4*o,O=t-S/2,p=n-g/2;return{render:function(){r&&(i.save(),i.globalAlpha=s,i.fillStyle=COLORS.c2,i.fillRect(O,p,S,g),i.fillStyle=COLORS.c3,i.font=h,i.fillText(r,t,n-o),i.font=d,i.fillText(c,t,n),i.font=d,i.fillText(u,t,n+o),i.restore())},update:function(){r&&(l?(s-=a)<0&&(r="",s=1):(s+=a)>1&&(s=1))},setContext:function(t){i=t},show:function(t){l=!1,[r,c,u]=t.split("."),setTimeout(R,f)},hide:R};function R(){l=!0}}function Robot(){const t=Array.from(Array(10),(t,n)=>n),n=permutations(t,4);let e,o,i;return{start:function(){e=getRandomItems(4,t),console.log("robot secret is ",e),o=[...n];const i=getRandomItems(4,t).join("");console.log("your secret is ",i)},handleScore:function(t){return 0===(o=reducePermutations(o,i,t[0],t[1])).length},getScore:function(t){return scoreGuess(e,t)},getGuess:function(){return i=pick(o)}}}function reducePermutations(t,n,e,o){const i=[...t];return 0===e?i.filter(function(t){return 0===t.reduce(r,0)}):i.filter(function(t){const[n,i]=t.reduce(c,[0,0]);return n===e&&i===o});function r(t,e){return-1!==n.indexOf(e)&&t++,t}function c(t,e,o){const i=n.indexOf(e);return-1!==i&&(t[0]++,i===o&&t[1]++),t}}function pick(t){return t[Math.floor(Math.random()*t.length)]}function getRandomItems(t,n){return shuffle(n).slice(0,t)}function scoreGuess(t,n){return t.reduce(function(t,e,o){const i=n.indexOf(e);-1!==i&&(t[0]+=1,i===o&&(t[1]+=1));return t},[0,0])}function permutations(t,n){const e=[];return function t(n,i,r=[]){if(r.length===i)e.push(r);else for(let e of n){const c=[...r];c.push(e);const u=o(e,n);t(u,i,c)}}(t,n),e;function o(t,n){return n.filter(n=>n!==t)}}function shuffle(t){for(let n=t.length-1;n>0;n--){const e=Math.floor(Math.random()*(n+1));[t[n],t[e]]=[t[e],t[n]]}return t}function Text({text:t="",fontFamily:n="fantasy",fontSize:e=14,align:o="center",strokeWidth:i=5,color:r,stroke:c,x:u,y:s,fontWeight:a}){let f;const l=`${a?`${a} `:""}${e}px ${n}`;return{render:function(){f.save(),f.font=l,f.textAlign=o,c&&(f.strokeStyle=c,f.lineWidth=i,f.strokeText(t,u,s));f.fillStyle=r,f.fillText(t,u,s),f.restore()},setContext:function(t){f=t},setText:function(n){t=n}}}function createTexture({dw:t,dh:n,df:e},o,i){const r=document.createElement("canvas"),c=r.getContext("2d"),u=t/2;return r.width=t,r.height=11*n,c.textAlign="center",c.textBaseline="middle",c.lineJoin="round",c.font=e,c.fillStyle=o,c.fillRect(0,0,t,r.height),c.fillStyle=i,Array.from({length:11},function(t,e){return{x:u,y:n/2+e*n,t:10===e?"":e}}).forEach(function({x:t,y:n,t:e}){c.fillText(e,t,n)}),r}function tween(t,n,e,o,i,r){const c={},u={},s=new Date,a=Object.keys(n),f={linear:function(t,n,e,o){return e*t/o+n},inQuad:function(t,n,e,o){return e*(t/=o)*t+n},outQuad:function(t,n,e,o){return-e*(t/=o)*(t-2)+n},inOutQuad:function(t,n,e,o){return(t/=o/2)<1?e/2*t*t+n:-e/2*(--t*(t-2)-1)+n},inCubic:function(t,n,e,o){return e*(t/=o)*t*t+n},outCubic:function(t,n,e,o){return e*((t=t/o-1)*t*t+1)+n},inOutCubic:function(t,n,e,o){return(t/=o/2)<1?e/2*t*t*t+n:e/2*((t-=2)*t*t+2)+n},inQuart:function(t,n,e,o){return e*(t/=o)*t*t*t+n},outQuart:function(t,n,e,o){return-e*((t=t/o-1)*t*t*t-1)+n},inOutQuart:function(t,n,e,o){return(t/=o/2)<1?e/2*t*t*t*t+n:-e/2*((t-=2)*t*t*t-2)+n},inQuint:function(t,n,e,o){return e*(t/=o)*t*t*t*t+n},outQuint:function(t,n,e,o){return e*((t=t/o-1)*t*t*t*t+1)+n},inOutQuint:function(t,n,e,o){return(t/=o/2)<1?e/2*t*t*t*t*t+n:e/2*((t-=2)*t*t*t*t+2)+n},inSine:function(t,n,e,o){return-e*Math.cos(t/o*(Math.PI/2))+e+n},outSine:function(t,n,e,o){return e*Math.sin(t/o*(Math.PI/2))+n},inOutSine:function(t,n,e,o){return-e/2*(Math.cos(Math.PI*t/o)-1)+n},inExpo:function(t,n,e,o){return 0===t?n:e*Math.pow(2,10*(t/o-1))+n},outExpo:function(t,n,e,o){return t==o?n+e:e*(1-Math.pow(2,-10*t/o))+n},inOutExpo:function(t,n,e,o){return 0===t?n:t==o?n+e:(t/=o/2)<1?e/2*Math.pow(2,10*(t-1))+n:e/2*(2-Math.pow(2,-10*--t))+n},inCirc:function(t,n,e,o){return-e*(Math.sqrt(1-(t/=o)*t)-1)+n},outCirc:function(t,n,e,o){return e*Math.sqrt(1-(t=t/o-1)*t)+n},inOutCirc:function(t,n,e,o){return(t/=o/2)<1?-e/2*(Math.sqrt(1-t*t)-1)+n:e/2*(Math.sqrt(1-(t-=2)*t)+1)+n},inElastic:function(t,n,e,o){var i=1.70158,r=0,c=e;return 0===t?n:1==(t/=o)?n+e:(r||(r=.3*o),c<Math.abs(e)?(c=e,i=r/4):i=r/(2*Math.PI)*Math.asin(e/c),-c*Math.pow(2,10*(t-=1))*Math.sin((t*o-i)*(2*Math.PI)/r)+n)},outElastic:function(t,n,e,o){var i=1.70158,r=0,c=e;return 0===t?n:1==(t/=o)?n+e:(r||(r=.3*o),c<Math.abs(e)?(c=e,i=r/4):i=r/(2*Math.PI)*Math.asin(e/c),c*Math.pow(2,-10*t)*Math.sin((t*o-i)*(2*Math.PI)/r)+e+n)},inOutElastic:function(t,n,e,o){var i=1.70158,r=0,c=e;return 0===t?n:2==(t/=o/2)?n+e:(r||(r=o*(.3*1.5)),c<Math.abs(e)?(c=e,i=r/4):i=r/(2*Math.PI)*Math.asin(e/c),t<1?c*Math.pow(2,10*(t-=1))*Math.sin((t*o-i)*(2*Math.PI)/r)*-.5+n:c*Math.pow(2,-10*(t-=1))*Math.sin((t*o-i)*(2*Math.PI)/r)*.5+e+n)},inBack:function(t,n,e,o,i){return void 0===i&&(i=1.70158),e*(t/=o)*t*((i+1)*t-i)+n},outBack:function(t,n,e,o,i){return void 0===i&&(i=1.70158),e*((t=t/o-1)*t*((i+1)*t+i)+1)+n},inOutBack:function(t,n,e,o,i){return void 0===i&&(i=1.70158),(t/=o/2)<1?e/2*(t*t*((1+(i*=1.525))*t-i))+n:e/2*((t-=2)*t*((1+(i*=1.525))*t+i)+2)+n},inBounce:function(t,n,e,o){return e-f.outBounce(o-t,0,e,o)+n},outBounce:function(t,n,e,o){return(t/=o)<1/2.75?e*(7.5625*t*t)+n:t<2/2.75?e*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?e*(7.5625*(t-=2.25/2.75)*t+.9375)+n:e*(7.5625*(t-=2.625/2.75)*t+.984375)+n},inOutBounce:function(t,n,e,o){return t<o/2?.5*f.inBounce(2*t,0,e,o)+n:.5*f.outBounce(2*t-o,0,e,o)+.5*e+n}},l=f[o];a.forEach(e=>{c[e]=t[e],u[e]=n[e]-c[e]}),function n(){let o=new Date-s;o<e?(a.forEach(n=>{t[n]=l(o,c[n],u[n],e)}),i(),requestAnimationFrame(n)):(o=e,a.forEach(n=>{t[n]=l(o,c[n],u[n],e)}),r())}()}function World(){const t=document.querySelector("canvas"),n=t.getContext("2d"),e=.3;let o=[],i=[],r=performance.now();return t.width=window.innerWidth,t.height=window.innerHeight,n.textAlign="center",n.textBaseline="middle",n.lineJoin="round",{getBounds:function(){return[t.width,t.height]},moveToTop:function(t){(o=o.filter(n=>n!==t)).push(t)},add:function(t){t.setContext(n),o.push(t),"function"==typeof t.update&&i.push(t)},reset:function(){o=[],i=[],c(r=performance.now())}};function c(u){const s=u-r;!function(t){i.forEach(n=>n.update(t))}(u),s>e&&(r=u,n.clearRect(0,0,t.width-10,t.height-10),o.forEach(t=>t.render())),requestAnimationFrame(c)}}keyboard.subscribe(onKey);
//# sourceMappingURL=g.js.map
