function getConfigs(t){const[e,n]=t,o=e/2,i=n/2;return function t(c){const r=Math.round(.618*c);const s=Math.round(.1*r);const u=16*r+8*s;if(u>e)return c=Math.round(.98*c),t(c);const f=Math.round(.618*r);const l=3*r;const a=l+c;const d=o+r;const h=d+5*r+3*s;const g=o-5*r-3*s;const S=g-3*r-s;const m=Math.round(1.618*c);const O=[{Class:Text,config:{text:"BRING THE NUMBER BACK!",x:o,y:r,color:COLORS.c5,stroke:COLORS.c2,fontSize:r,fontFamily:"fantasy"}},{Class:Text,config:{text:"YOUR GUESS",x:d,y:l,color:COLORS.c5,stroke:COLORS.c2,fontSize:f,fontWeight:"bold",align:"left",fontFamily:"system-ui"}},{Class:Text,config:{text:"ROBOT GUESS",x:o-r,y:l,color:COLORS.c5,stroke:COLORS.c2,fontSize:f,fontWeight:"bold",align:"right",fontFamily:"system-ui"}},{Class:Text,config:{text:"SCORE",x:h,y:l,color:COLORS.c5,stroke:COLORS.c2,fontSize:f,fontWeight:"bold",align:"left",fontFamily:"system-ui"}},{Class:Text,config:{text:"SCORE",x:S+2*r+s,y:l,color:COLORS.c5,stroke:COLORS.c2,fontSize:f,fontWeight:"bold",align:"right",fontFamily:"system-ui"}}];return{width:e,height:n,centerX:o,centerY:i,initBlockY:a,rightBlockX:d,leftBlockX:g,rightBlockX1:h,leftBlockX1:S,stepHeight:m,digitBlockConfig:{dw:r,dh:c,dg:s},staticItems:O}}(Math.round(n/16))}const COLORS={c1:"#26717F",c2:"#0A4B59",c3:"#B19F3C",c4:"#F2AC29",c5:"#DB5C43"},RESULTS={USER:"You won!.A genuine triumph of the human mind.Hit Space to beat that piece of metal again",ROBOT:"TRY AGAIN",DRAW:"It's a draw.You almost there.Hit Space to try again."};function Game(t,e){const{centerX:n,centerY:o,initBlockY:i,rightBlockX:c,leftBlockX:r,rightBlockX1:s,leftBlockX1:u,stepHeight:f,digitBlockConfig:l}=e,a=new Robot,d=new ResultDisplay(n,o,l);let h,g,S,m;return{start:function(){h=0,g=[],a.start(),C(a.getGuess())}};function O(t){const e=t.join("");if(g.includes(e))alert("You already have this guess"),S.reset(),S.activate();else{g.push(e),x(a.getScore(t))}}function R(t){m=t,a.handleScore(t),C()}function x(e){const n=i+h*f,o=e?s:u,c=e?COLORS.c3:COLORS.c4,r=new InputSet("score",o,n,l,c);if(t.add(r),e){r.setDigits(e),h++;const n=function(t){let e=null,n=y(t),o=y(m);o&&n?e=RESULTS.DRAW:o?e=RESULTS.ROBOT:n&&(e=RESULTS.USER);return e}(e);if(n)g=n,t.add(d),d.show(g);else{C(a.getGuess())}}else r.setOnSubmit(R),r.activate();var g}function C(e){const n=i+h*f,o=e?r:c,s=e?COLORS.c3:COLORS.c4,u=new InputSet("guess",o,n,l,s);t.add(u),e?(u.setDigits(e),x()):(u.setOnSubmit(O),u.activate(),S=u)}function y(t){return 4===t[0]&&4===t[1]}}function InputItem(t,e,n,{dw:o,dh:i,dg:c},r,s){let u,f="";const l=e+t*(o+c),a=l+o/2,d=n+i/2,h=`bold ${.618*i}px monospace`;let g=!1;return{render:function(){u.fillStyle=g?COLORS.c5:r,u.fillRect(l,n,o,i),u.fillStyle=s,u.font=h,u.fillText(f,a,d)},setContext:function(t){u=t},setDigit:function(t){f=t},activate:function(){g=!0},deactivate:function(){g=!1}}}function InputSet(t,e,n,{dw:o,dh:i,dg:c},r){let s,u,f,l=null,a=[];const d="score"===t;d?(u=2,f=function(t){return t>=0&&t<=4}):(u=4,f=function(t){return!a.includes(t)});const h=Array.from({length:u},(t,s)=>new InputItem(s,e,n,{dw:o,dh:i,dg:c},r,COLORS.c1));return{render:function(){h.forEach(t=>t.render())},setContext:function(t){h.forEach(e=>e.setContext(t))},setOnSubmit:function(t){s=t},setDigits:function(t){h.forEach((e,n)=>e.setDigit(t[n]))},activate:function(){window.addEventListener("keyup",g),h[l=0].activate()},reset:function(){a=[],h.forEach((t,e)=>t.setDigit(""))}};function g(t){if(null!==l){const n=Number(t.key);e=n,Number.isInteger(e)?function(t){if(!f(t))return;const e=a[l];if(a[l]=t,d&&a[0]<a[1])return void(a[l]=e);h[l].setDigit(t),S()}(n):"ArrowRight"===t.key?S():"ArrowLeft"===t.key?function(){h[l].deactivate(),(l-=1)<0&&(l=u-1);h[l].activate()}():"Enter"===t.key&&a.length===u&&(h[l].deactivate(),l=null,window.removeEventListener("keyup",g),s(a))}var e}function S(){h[l].deactivate(),h[l=(l+1)%u].activate()}}function Line({p1:t,p2:e,width:n,color:o}){let i;this.isStatic=!0,this.render=(()=>{i.save(),i.strokeStyle=o,i.lineWidth=n,i.beginPath(),i.moveTo(t.x,t.y),i.lineTo(e.x,e.y),i.stroke(),i.restore()}),this.setContext=(t=>{i=t})}const world=new World,configs=getConfigs(world.getBounds()),game=new Game(world,configs);function init(){world.reset(),configs.staticItems.forEach(createStaticItem),game.start()}function createStaticItem({Class:t,config:e}){const n=new t(e);world.add(n)}function ResultDisplay(t,e,{dw:n,dh:o}){let i,c="",r="",s="",u=0,f=.03;const l=4e3;let a=!1;const d=`bold ${.618*o}px monospace`,h=`bold ${.618*o*.618}px monospace`,g=16*n,S=4*o,m=t-g/2,O=e-S/2;return{render:function(){c&&(i.save(),i.globalAlpha=u,i.fillStyle=COLORS.c2,i.fillRect(m,O,g,S),i.fillStyle=COLORS.c3,i.font=d,i.fillText(c,t,e-o),i.font=h,i.fillText(r,t,e),i.font=h,i.fillText(s,t,e+o),i.restore())},update:function(){c&&(a?(u-=f)<0&&(c=""):(u+=f)>1&&(u=1))},setContext:function(t){i=t},show:function(t){[c,r,s]=t.split("."),setTimeout(R,l)},hide:R};function R(){a=!0}}function Robot(){const t=Array.from(Array(10),(t,e)=>e),e=permutations(t,4);let n,o,i;return{start:function(){n=getRandomItems(4,t),console.log("robot secret is ",n),o=[...e];const i=getRandomItems(4,t).join("");console.log("your secret is ",i)},handleScore:function(t){o=reducePermutations(o,i,t[0],t[1])},getScore:function(t){return scoreGuess(n,t)},getGuess:function(){return i=pick(o)}}}function reducePermutations(t,e,n,o){const i=[...t];return 0===n?i.filter(function(t){return 0===t.reduce(c,0)}):i.filter(function(t){const[e,i]=t.reduce(r,[0,0]);return e===n&&i===o});function c(t,n){return-1!==e.indexOf(n)&&t++,t}function r(t,n,o){const i=e.indexOf(n);return-1!==i&&(t[0]++,i===o&&t[1]++),t}}function pick(t){return t[Math.floor(Math.random()*t.length)]}function getRandomItems(t,e){return shuffle(e).slice(0,t)}function scoreGuess(t,e){return t.reduce(function(t,n,o){const i=e.indexOf(n);-1!==i&&(t[0]+=1,i===o&&(t[1]+=1));return t},[0,0])}function permutations(t,e){const n=[];return function t(e,i,c=[]){if(c.length===i)n.push(c);else for(let n of e){const r=[...c];r.push(n);const s=o(n,e);t(s,i,r)}}(t,e),n;function o(t,e){return e.filter(e=>e!==t)}}function shuffle(t){for(let e=t.length-1;e>0;e--){const n=Math.floor(Math.random()*(e+1));[t[e],t[n]]=[t[n],t[e]]}return t}function Text({text:t="",fontFamily:e="fantasy",fontSize:n=14,align:o="center",strokeWidth:i=5,color:c,stroke:r,x:s,y:u,fontWeight:f}){let l;const a=`${f?`${f} `:""}${n}px ${e}`;return{render:function(){l.save(),l.font=a,l.textAlign=o,r&&(l.strokeStyle=r,l.lineWidth=i,l.strokeText(t,s,u));l.fillStyle=c,l.fillText(t,s,u),l.restore()},setContext:function(t){l=t},setText:function(e){t=e}}}function World(){const t=document.querySelector("canvas"),e=t.getContext("2d"),n=.3;let o=[],i=[],c=!0,r=performance.now(),s=0;function u(f){if(s>3)return;const l=f-r;!function(t){for(let e=i.length-1;e>=0;e--)i[e].update(t)}(f),l>n&&(r=f,e.clearRect(0,0,t.width-10,t.height-10),o.forEach(t=>t.render())),c&&s++,requestAnimationFrame(u)}t.width=window.innerWidth,t.height=window.innerHeight,e.textAlign="center",e.textBaseline="middle",e.lineJoin="round",this.getBounds=(()=>[t.width,t.height]),this.getContext=(()=>e),this.add=(t=>{t.setContext(e),o.push(t),"function"==typeof t.update&&i.push(t)}),this.reset=(()=>{c=!1,o=[],r=performance.now(),s=0,u(r)})}init();
//# sourceMappingURL=g.js.map
